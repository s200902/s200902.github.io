<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>è¶…é«˜é€Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆ + Pingãƒ„ãƒ¼ãƒ«ï¼ˆã‚µã‚¤ãƒˆçŠ¶æ³è¡¨ç¤ºä»˜ãï¼‰</title>
<style>
body { font-family: sans-serif; margin: 20px; }
input, select, textarea, button {
display: block; width: 100%; margin-top: 10px; padding: 8px;
}
textarea { height: 80px; }
#requestResponse, #pingResponse {
margin-top: 20px; padding: 10px; background: #f9f9f9; border: 1px solid #ccc;
font-family: monospace; white-space: pre-wrap; max-height: 300px; overflow-y: auto;
}
.error-log {
color: red;
font-size: 0.9em;
margin-top: 5px;
}
/* ãƒ­ã‚°ç”¨ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ */
#reqLog, #pingLog {
height: 200px;
font-family: monospace;
background: #222;
color: #0f0;
overflow-y: auto;
white-space: pre-wrap;
margin-top: 10px;
resize: vertical;
}
/* iframeã®ã‚¹ã‚¿ã‚¤ãƒ« */
.iframe-container {
margin-top: 15px;
border: 2px solid #444;
height: 400px;
width: 100%;
}
iframe {
width: 100%;
height: 100%;
border: none;
}
</style>
</head>
<body>
<h1>ğŸš€ è¶…é«˜é€Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆ + âš¡ Pingãƒ„ãƒ¼ãƒ«ï¼ˆã‚µã‚¤ãƒˆçŠ¶æ³è¡¨ç¤ºä»˜ãï¼‰</h1>

<!-- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ -->
<section>
<h2>ğŸ“¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</h2>
<label>URL:</label>
<input type="text" id="reqUrl" placeholder="https://example.com" />
<label><input type="checkbox" id="reqProxy" checked> ãƒ—ãƒ­ã‚­ã‚·ä½¿ç”¨ï¼ˆCORSå›é¿ï¼‰</label>
<label>HTTPãƒ¡ã‚½ãƒƒãƒ‰:</label>
<select id="reqMethod">
<option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option><option>PATCH</option>
</select>
<label>ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:</label>
<textarea id="reqBody" placeholder='{"key":"value"}'></textarea>
<label>ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆkey:valueï¼‰:</label>
<textarea id="reqHeaders" placeholder="Authorization: Bearer xxx"></textarea>
<label>é€ä¿¡é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰:</label>
<input type="number" id="reqInterval" value="1.51" min="0.5" step="0.01" />
<button id="reqStart">â–¶ï¸ é€ä¿¡é–‹å§‹</button>
<button id="reqStop" disabled>â¹ï¸ åœæ­¢</button>
<div id="requestResponse">é€ä¿¡å›æ•°: 0</div>
<label>é€ä¿¡ãƒ­ã‚°:</label>
<textarea id="reqLog" readonly></textarea>
<label>å¯¾è±¡ã‚µã‚¤ãƒˆã®çŠ¶æ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆURLï¼‰:</label>
<div class="iframe-container">
<iframe id="reqIframe" src=""></iframe>
</div>
<div class="error-log" id="reqErrors"></div>
</section>

<hr>

<!-- Ping -->
<section>
<h2>âš¡ Pingãƒ„ãƒ¼ãƒ«</h2>
<label>Pingå¯¾è±¡URL:</label>
<input type="text" id="pingUrl" placeholder="https://example.com" />
<label><input type="checkbox" id="pingProxy" checked> ãƒ—ãƒ­ã‚­ã‚·ä½¿ç”¨ï¼ˆCORSå›é¿ï¼‰</label>
<label>Pingé–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰:</label>
<input type="number" id="pingInterval" value="1.51" min="0.5" step="0.01" />
<button id="pingStart">â–¶ï¸ Pingé–‹å§‹</button>
<button id="pingStop" disabled>â¹ï¸ åœæ­¢</button>
<div id="pingResponse">Pingå›æ•°: 0</div>
<label>Pingãƒ­ã‚°:</label>
<textarea id="pingLog" readonly></textarea>
<label>å¯¾è±¡ã‚µã‚¤ãƒˆã®çŠ¶æ³ï¼ˆPing URLï¼‰:</label>
<div class="iframe-container">
<iframe id="pingIframe" src=""></iframe>
</div>
<div class="error-log" id="pingErrors"></div>
</section>

<script>
let reqRunning = false, reqCount = 0, reqTimer = null, reqSuccess = 0, reqFail = 0;
let pingRunning = false, pingCount = 0, pingTimer = null, pingSuccess = 0, pingFail = 0;
const reqErrorLog = [], pingErrorLog = [];
const reqLogLines = [];
const pingLogLines = [];

function parseHeaders(input) {
const lines = input.split('\n');
const headers = {};
for (const line of lines) {
const [key, ...rest] = line.split(':');
if (key && rest.length) headers[key.trim()] = rest.join(':').trim();
}
return headers;
}

function updateDisplay() {
if (reqRunning) {
document.getElementById('requestResponse').textContent =
`é€ä¿¡å›æ•°: ${reqCount}ï¼ˆæˆåŠŸ: ${reqSuccess} / å¤±æ•—: ${reqFail}ï¼‰`;
document.getElementById('reqErrors').textContent = reqErrorLog.slice(-10).join('\n');
}
if (pingRunning) {
document.getElementById('pingResponse').textContent =
`Pingå›æ•°: ${pingCount}ï¼ˆæˆåŠŸ: ${pingSuccess} / å¤±æ•—: ${pingFail}ï¼‰`;
document.getElementById('pingErrors').textContent = pingErrorLog.slice(-10).join('\n');
}
requestAnimationFrame(updateDisplay);
}
requestAnimationFrame(updateDisplay);

// URLå¤‰æ›´æ™‚ã«iframeæ›´æ–°ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ï¼‰
document.getElementById('reqUrl').addEventListener('input', () => {
const url = document.getElementById('reqUrl').value.trim();
if (url) {
document.getElementById('reqIframe').src = url;
} else {
document.getElementById('reqIframe').src = '';
}
});

// URLå¤‰æ›´æ™‚ã«iframeæ›´æ–°ï¼ˆPingç”¨ï¼‰
document.getElementById('pingUrl').addEventListener('input', () => {
const url = document.getElementById('pingUrl').value.trim();
if (url) {
document.getElementById('pingIframe').src = url;
} else {
document.getElementById('pingIframe').src = '';
}
});

// è¶…é«˜é€Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆé–‹å§‹
document.getElementById('reqStart').onclick = () => {
const baseUrl = document.getElementById('reqUrl').value.trim();
if (!baseUrl) return alert("URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
const useProxy = document.getElementById('reqProxy').checked;
const finalUrl = useProxy ? "https://cors-anywhere.herokuapp.com/" + baseUrl : baseUrl;
const method = document.getElementById('reqMethod').value;
const body = document.getElementById('reqBody').value;
const headers = parseHeaders(document.getElementById('reqHeaders').value);
const interval = parseFloat(document.getElementById('reqInterval').value) || 1.51;

if (method !== 'GET' && body.trim()) headers['Content-Type'] = 'application/json';
const options = { method, headers };
if (method !== 'GET' && body.trim()) options.body = body;

reqRunning = true;
reqCount = 0; reqSuccess = 0; reqFail = 0; reqErrorLog.length = 0;
reqLogLines.length = 0;
document.getElementById('reqLog').value = '';
document.getElementById('reqStart').disabled = true;
document.getElementById('reqStop').disabled = false;

reqTimer = setInterval(async () => {
if (!reqRunning) return;
reqCount++;
try {
const res = await fetch(finalUrl, options);
reqSuccess++;

let textSnippet = '';
try {
const text = await res.clone().text();
textSnippet = text.slice(0, 100).replace(/\s+/g, ' ');
} catch {
textSnippet = '';
}

addReqLog(`[${new Date().toLocaleTimeString()}] æˆåŠŸ: ${res.status} ${res.statusText} - ${textSnippet}`);

} catch (err) {
reqFail++;
addReqLog(`[${new Date().toLocaleTimeString()}] ã‚¨ãƒ©ãƒ¼: ${err.message}`);
}
}, interval);
};

// è¶…é«˜é€Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆåœæ­¢
document.getElementById('reqStop').onclick = () => {
reqRunning = false;
clearInterval(reqTimer);
document.getElementById('reqStart').disabled = false;
document.getElementById('reqStop').disabled = true;
};

// Pingé–‹å§‹
document.getElementById('pingStart').onclick = () => {
const baseUrl = document.getElementById('pingUrl').value.trim();
if (!baseUrl) return alert("Ping URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
const useProxy = document.getElementById('pingProxy').checked;
const finalUrl = useProxy ? "https://cors-anywhere.herokuapp.com/" + baseUrl : baseUrl;
const interval = parseFloat(document.getElementById('pingInterval').value) || 1.51;

pingRunning = true;
pingCount = 0; pingSuccess = 0; pingFail = 0; pingErrorLog.length = 0;
pingLogLines.length = 0;
document.getElementById('pingLog').value = '';
document.getElementById('pingStart').disabled = true;
document.getElementById('pingStop').disabled = false;

pingTimer = setInterval(async () => {
if (!pingRunning) return;
pingCount++;
try {
const res = await fetch(finalUrl, { method: 'HEAD', cache: 'no-store' });
pingSuccess++;
addPingLog(`[${new Date().toLocaleTimeString()}] æˆåŠŸ: ${res.status} ${res.statusText}`);
} catch (err) {
pingFail++;
addPingLog(`[${new Date().toLocaleTimeString()}] ã‚¨ãƒ©ãƒ¼: ${err.message}`);
}
}, interval);
};

// Pingåœæ­¢
document.getElementById('pingStop').onclick = () => {
pingRunning = false;
clearInterval(pingTimer);
document.getElementById('pingStart').disabled = false;
document.getElementById('pingStop').disabled = true;
};

// è¶…é«˜é€Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°æ›´æ–°
function addReqLog(line) {
reqLogLines.unshift(line);
if (reqLogLines.length > 100) reqLogLines.pop();
document.getElementById('reqLog').value = reqLogLines.join('\n');
}

// Pingãƒ­ã‚°æ›´æ–°
function addPingLog(line) {
pingLogLines.unshift(line);
if (pingLogLines.length > 100) pingLogLines.pop();
document.getElementById('pingLog').value = pingLogLines.join('\n');
}
</script>
</body>
</html>
